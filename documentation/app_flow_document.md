# AI Flashcard Generator - Application Flow Document

## Overview

The AI Flashcard Generator is a Next.js application that uses OpenAI's API to analyze course transcripts and generate study flashcards. The application follows a clear linear flow from document upload to flashcard creation and review.

## System Initialization

Before any user interaction, the application performs a server-side check for proper OpenAI API configuration:

- **Component**: `ServerConfigCheck` in `/components/server-config-check.tsx`
- If API key is missing or invalid, displays configuration instructions
- If properly configured, renders the application content

## Application Flow

### 1. Home Page (Upload)

**Path**: `/app/page.tsx`  
**Primary Component**: `Upload` from `/components/upload.tsx`

**User Flow**:
- User lands on the homepage
- User can toggle language (English/French) and theme (Light/Dark)
- User uploads a document (TXT, DOCX, or PDF format)
- File is validated for format and size (500-50,000 words)

**Technical Implementation**:
- Client-side file processing using `/lib/document-converter.ts`
- Extracted text stored in `sessionStorage` as "transcript"
- User is redirected to the processing page

### 2. Processing Page

**Path**: `/app/processing/page.tsx`

**User Flow**:
- User sees a loading indicator with progress bar
- System analyzes the transcript content
- Automatic redirection to results page when complete

**Technical Implementation**:
- Retrieves transcript from `sessionStorage`
- Calls `analyzeTranscript()` from `/lib/ai.ts` to process text
- Shows progress indicators (simulated incremental progress)
- Stores analysis results in `sessionStorage` as "courseData"
- Stores the content language in `sessionStorage` as "contentLanguage"
- Redirects to `/results` when processing completes

### 3. Results Page

**Path**: `/app/results/page.tsx`

**User Flow**:
- User sees the analyzed course subject
- User sees an outline of key points extracted from the document
- User clicks "I'm Ready" to proceed to flashcards

**Technical Implementation**:
- Retrieves course data from `sessionStorage`
- Displays subject and outline sections
- "I'm Ready" button redirects to `/flashcards`

### 4. Flashcards Page

**Path**: `/app/flashcards/page.tsx`

**User Flow**:
- User views flashcards generated from the document
- User can toggle between question and answer views
- User navigates to the next flashcard
- Additional flashcards are generated automatically as needed
- User can stop the session to see a summary

**Technical Implementation**:
- Retrieves course data and transcript from `sessionStorage`
- Uses `generateFlashcards()` to create batches of 10 flashcards
- Handles question/answer toggling with state management
- Automatically generates more cards when the user reaches the end of current set
- Stores all studied flashcards in `sessionStorage` when stopped
- Redirects to `/summary` when user stops the session

### 5. Summary Page

**Path**: `/app/summary/page.tsx`

**User Flow**:
- User sees a list of all flashcards studied in the session
- User can review all questions and answers
- User clicks "Finish" to end the session and return to homepage

**Technical Implementation**:
- Retrieves flashcards from `sessionStorage`
- Displays all flashcards with questions and answers
- "Finish" button clears `sessionStorage` and redirects to homepage

## Data Management

The application uses `sessionStorage` to maintain state between pages:

1. **transcript**: Raw text extracted from the uploaded document
2. **courseData**: JSON object with subject and outline generated by AI
3. **contentLanguage**: Language used for content generation (en/fr)
4. **flashcards**: Array of all studied flashcards

## API Integration

The application communicates with OpenAI through a single route handler:

**Endpoint**: `POST /api/ai/route.ts`  
**Operations**:
- `analyze`: Processes transcript to extract subject and outline
- `generate`: Creates a single flashcard based on course content
- `generate-batch`: Creates multiple flashcards in one request (batch of 10)

## Language Support

The application implements dual language support:

1. **UI Language**
   - Managed by `LanguageProvider` from `/hooks/use-language.tsx`
   - User can toggle between English and French
   - UI elements use translations from `/lib/translations.ts`

2. **Content Language**
   - Initially matches UI language
   - Used for generating AI content in the appropriate language
   - Persists throughout the session for consistency

## Error Handling

Each page includes comprehensive error handling:
- Checks for missing data in `sessionStorage` (redirects to home)
- Handles AI processing failures with error toasts
- Provides clear feedback for configuration issues

## User Experience Enhancements

- **Progress Indicators**: Visual feedback during AI processing
- **Loading States**: Clear indication when system is generating content
- **Toast Notifications**: Status updates and error messages
- **Mobile Optimization**: Responsive design for all device sizes